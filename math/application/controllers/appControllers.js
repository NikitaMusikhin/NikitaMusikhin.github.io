angular.module("User",["ngResource","ngStorage"]).controller("regCtrl",["$scope","$location","UserService",function(e,t,o){e.addNewUser=function(n){o.user.create(n,function(e){alert("Поздравляем,вы успешно зарегистрированы!"),t.path("/login")},function(){alert("So sad")}),e.regForm.$setPristine(),e.user={}},e.getError=function(e){if(angular.isDefined(e)){if(e.required)return"Поле не должно быть пустым";if(e.minlength)return"В данное поле должно быть введено более 6 символов";if(e.email)return"Введите корректные данные"}}}]).controller("loginCtrl",["$scope","$rootScope","$http","$location","UserService","TokenService",function(e,t,o,n,r,a){e.authorize=function(e){r.auth.login(e,function(e){a.setToken(e.token),t.user=e.user,n.path("/dashboard")},function(){alert(":(")})}}]).controller("profCtrl",["$scope","$rootScope","$localStorage","$location","UserService",function(e,t,o,n,r){e.logout=function(){r.out.logout({},function(e){delete o.token,n.path("/login")},function(){alert(":(")})},o.token?t.user||r.mathContext.isToken({},function(e){t.user=e.user},function(){n.path("/login")}):n.path("/login"),t.$watch("user",function(){e.profile=t.user}),e.setExample=function(e){o.exSession=e}}]).controller("exampleCtrl",["$scope","$rootScope","$localStorage","$location","UserService",function(e,t,o,n,r){o.token?t.user||r.mathContext.isToken({},function(e){t.user=e.user},function(){n.path("/login")}):n.path("/login"),t.$watch("user",function(){e.profile=t.user}),o.exSession?e.exampleSession=o.exSession:n.path("/dashboard"),e.bolsheDesyati=!0,e.getRandomNumber=function(){return Math.floor(6*Math.random()+1)},e.count={access:0,wrong:0,free:0},e.setExampleType=function(t,o){switch(e.exampleSession){case"add":e.example={primer:e.x+" + "+e.y,otvet:e.x+e.y,otvetUsera:parseInt("")};break;case"sub":e.example={primer:e.x+" - "+e.y,otvet:e.x-e.y,otvetUsera:parseInt("")};break;case"mull":e.example={primer:e.x+" * "+e.y,otvet:e.x*e.y,otvetUsera:parseInt("")};break;case"div":e.example={primer:e.x+" / "+e.y,otvet:e.x/e.y,otvetUsera:parseInt("")};break;default:n.path("/dashboard")}},e.startSolutions=function(){e.count.free=0,e.count.wrong=0,e.count.access=0,e.blockInput=!1,e.bolsheDesyati=!0,e.generateNewExample()},e.generateNewExample=function(){e.count.free<10?(e.x=e.getRandomNumber(),e.y=e.getRandomNumber(),e.setExampleType(e.x,e.y),e.primerGotov=!0,e.saveSolution=function(t){t==e.example.otvet?e.count.access++:e.count.wrong++,e.count.free++}):(e.blockInput=!0,e.bolsheDesyati=!1,delete o.exSession)}}]);